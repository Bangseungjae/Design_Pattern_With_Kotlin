# 프록시 패턴(Proxy Pattern)

데코레이터 패턴과 마찬가지로 객체의 기능을 확장한다.

데코레이터는 추가적인 동작을 할지언정 요청한 동작은 항상 그대로 수행한다.

하지만 프록시는 어떤 동작을 요청했을 때 완전히 다른 식으로 동작할 수 있다.

값비싼 객체

- 네트워크 자원에 접근하거나 생성 시간이 오래 걸리는 객체

ex)

웃긴 고양이 앱

매일 웃긴 고양이 사진이 한 장 올라온다. 홈페이지와 모바일 앱에서 사용자는 수천 장의 웃긴 고양이 사진을 볼 수 있다. 그 중 하나를 클릭하거나 터치하면 사진이 전체 화면으로 표시됨

네트워크를 통해 고양이 사진을 받아오는 것은 매우 값비싼 동작이며 메모리도 많이 필요하다. 그래서 한 번만 받아 오기를 원한다.

사진을 한 번 받는 것을 피할 수는 없다. 하지만 두 번째 사진을 요청했을 땐 다시 네트워크를 통해 사진을 받아오는 대신 메모리에 캐시돼 있는 사진을 전달하는 것. 이게 **프록시 패턴**의 핵심이다.

기대하는 동작을 그대로 하는 대신 조금 꾀를 부려서 이미 준비된 사진을 전달하는 것이다.

```kotlin
import java.net.URL

data class CatImage(
    val thumbnailUrl: String,
    val url: String,
) {
    val image: ByteArray by lazy {
        //이미지를 바이트 배열로 읽는다.
        URL(url).readBytes()
    }
}
```

간혹 프록시 디자인 패턴을 3개의 하위 패턴으로 분류하기도 한다.

- **가상 프록시**: 게으른 방식으로 결과를 캐시한다.
- **원격 프록시**: 원격지의 자원에 접근한다.
- **보호 프록시 또는 접근 제어 프록시**: 인가되지 않은 접근을 거부한다.
